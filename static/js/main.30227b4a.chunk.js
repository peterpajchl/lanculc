(this.webpackJsonplanculc=this.webpackJsonplanculc||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(9),s=n.n(a),o=(n(15),n(2)),i=(n(16),n(0));var l=function(e){var t=e.selected,n=e.rates,c=e.onChange;return Object(i.jsx)("select",{value:t,onChange:function(e){return c(e.currentTarget.value)},children:n.map((function(e){return Object(i.jsx)("option",{value:e[0],children:e[0]},e[0])}))})};var u=function(e){var t=e.rates,n=e.onUpdate,r=Object(c.useState)([]),a=Object(o.a)(r,2),s=a[0],u=a[1],j=Object(c.useState)(0),d=Object(o.a)(j,2),b=d[0],f=d[1];return Object(c.useEffect)((function(){var e=parseFloat(b)/s[1];console.log("client: broadcast client amount",parseFloat(b),s[1],e),n(e)}),[n,b,s]),Object(c.useEffect)((function(){console.log("client: rates refreshed"),t&&t.length&&(console.log("client: setting default rate to ",t[0]),u(t[0]))}),[t]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"What you charged client"}),Object(i.jsxs)("form",{className:"client-form",children:[Object(i.jsx)("input",{type:"number",min:"0",id:"client-cost-rate",value:b,onChange:function(e){return f(e.currentTarget.value)},placeholder:"e.g. 0.15"}),Object(i.jsx)(l,{selected:s?s[0]:"",rates:t,onChange:function(e){console.log("client: explicit rate changed",e);var n=t.find((function(t){return t[0]===e}));u(n)}}),Object(i.jsx)("span",{children:0===s.length?0:new Intl.NumberFormat("en-IN",{style:"currency",currency:s[0]}).format(s[1])})]})]})},j=n(8),d=n(3);var b=function(e){var t=e.rates,n=e.service,r=e.updateItem,a=e.removeItem,s=e.index,u=Object(c.useState)([]),j=Object(o.a)(u,2),b=j[0],f=j[1];return Object(c.useEffect)((function(){console.log("service changed",n)}),[n]),Object(c.useEffect)((function(){console.log("service ".concat(s,": rates refreshed")),t&&t.length&&(console.log("service ".concat(s,": setting default rate to ").concat(t[0])),f(t[0]))}),[t,s]),Object(i.jsxs)("li",{className:"service-row",children:[Object(i.jsxs)("span",{className:"service-row__index",children:[s+1,"."]}),Object(i.jsx)("input",{className:"service-row__description",name:"description",type:"text",value:n.description,onChange:function(e){var t=Object(d.a)(Object(d.a)({},n),{},{description:e.currentTarget.value});console.log("will update service-desc at index",s,t),r(s,t)},placeholder:"Review"}),Object(i.jsx)("input",{className:"service-row__amount",name:"amount",type:"number",min:"0",value:n.amount,onChange:function(e){var t=Object(d.a)(Object(d.a)({},n),{},{amount:e.currentTarget.value});console.log("service: will update service-amount at index",s,t),r(s,t)},placeholder:"0.08"}),Object(i.jsx)(l,{selected:b?b[0]:"",rates:t,onChange:function(e){console.log("service: explicit rate changed",e);var c=t.find((function(t){return t[0]===e}));f(c);var a=Object(d.a)(Object(d.a)({},n),{},{rate:c});console.log("service: will update service-rate at index",s,a),r(s,a)}}),Object(i.jsx)("span",{className:"service-row__rate",children:0===n.rate.length?0:new Intl.NumberFormat("en-IN",{style:"currency",currency:n.rate[0]}).format(n.rate[1])}),Object(i.jsx)("button",{type:"button",onClick:function(){return a(s)},children:"\xd7"})]})};var f=function(e){var t=e.rates,n=e.onUpdate,r=Object(c.useState)([]),a=Object(o.a)(r,2),s=a[0],l=a[1],u=Object(c.useState)(0),d=Object(o.a)(u,2),f=d[0],p=d[1],v=function(e,t){console.log("suppliers: update item");var n=Object(j.a)(s);n[e]=t,l(n)},O=function(e){console.log("suppliers: remove item at index ",e),l(s.filter((function(t,n){return n!==e})))};return Object(c.useEffect)((function(){console.log("suppliers: effect set total"),0===s.length?p(0):p(function(e){var t=e.reduce((function(e,t){return e+t.amount/t.rate[1]}),0);return console.log("suppliers: total ",t),t}(s))}),[n,s]),Object(c.useEffect)((function(){console.log("suppliers: broadcast total"),n(f)}),[n,f]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Paid out to suppliers per service"}),Object(i.jsx)("form",{action:"/",method:"post",className:"service-form",children:Object(i.jsx)("ol",{className:"service-list",children:s.map((function(e,n){return Object(i.jsx)(b,{rates:t,service:e,updateItem:v,removeItem:O,index:n},n)}))})}),Object(i.jsxs)("div",{className:"total-bar",children:[Object(i.jsx)("button",{className:"primary-button",type:"button",onClick:function(){console.log("suppliers: add item");l([].concat(Object(j.a)(s),[{description:"",amount:0,rate:["GBP",1]}]))},children:"Add item"}),Object(i.jsxs)("span",{children:["Total: ",f]})]})]})};var p=function(e){var t=e.clientRate,n=e.supplierCost;return Object(c.useEffect)((function(){console.log("margin: ",t,n)}),[t,n]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Margin"}),Object(i.jsxs)("div",{className:"margin__value",children:[t>0?(t-n)/t*100:0," %"]})]})},v=n(7),O=n.n(v),h=n(10);function m(){return m=Object(h.a)(O.a.mark((function e(){var t,n,c=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.length>0&&void 0!==c[0]?c[0]:"GBP",e.next=3,fetch("https://v6.exchangerate-api.com/v6/427cd3ffeae153ee12b4834e/latest/GBP");case 3:return t=e.sent,e.next=6,t.json();case 6:return n=e.sent,e.abrupt("return",{base:n.base_code,rates:n.conversion_rates,lastUpdated:n.time_last_update_unix});case 8:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}var g=function(){return m.apply(this,arguments)};var x=function(){var e=Object(c.useState)(0),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),s=Object(o.a)(a,2),l=s[0],j=s[1],d=Object(c.useState)([]),b=Object(o.a)(d,2),v=b[0],O=b[1];return Object(c.useEffect)((function(){console.log("#1 - get rates"),g().then((function(e){var t=Object.entries(e.rates);O(t)}))}),[]),Object(i.jsxs)("div",{className:"app",children:[Object(i.jsx)(u,{rates:v,onUpdate:r}),Object(i.jsx)(f,{rates:v,onUpdate:j}),Object(i.jsx)(p,{clientRate:n,supplierCost:l})]})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,20)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};s.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(x,{})}),document.getElementById("root")),y()}},[[19,1,2]]]);
//# sourceMappingURL=main.30227b4a.chunk.js.map